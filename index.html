<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æœ€çµ‚æ”»æ’ƒåŠ›ãƒ»ã‚«ãƒ¼ãƒ‰å€ç‡è¨ˆç®—ãƒ„ãƒ¼ãƒ«ï¼ˆãƒ•ãƒ©ãƒƒãƒˆãƒ€ãƒ¼ã‚¯UIï¼‰</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');

  body {
    font-family: 'Orbitron', sans-serif;
    background: #0a0a0f;
    color: #fff;
    margin: 0;
    padding: 1em;
  }

  h1 {
    text-align: center;
    color: #ff6ec7;
    font-size: 2em;
    margin-bottom: 1em;
  }

  h2 {
    font-size: 1.3em;
    margin-bottom: 0.5em;
    color: #7afcff;
  }

  .container {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: center;
  }

  .section {
    background: #1b1b2d;
    border-radius: 12px;
    padding: 24px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.7);
    flex: 1 1 400px;
    min-width: 300px;
  }

  .section.atkDamageSection {
    flex-basis: 100%;
  }

  .formRow {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
    flex-wrap: wrap;
  }

  label {
    width: 160px;
    font-weight: bold;
    color: #7afcff;
  }

  input[type="number"] {
    width: 100px;
    padding: 6px 10px;
    border-radius: 6px;
    border: 1px solid #7afcff;
    background: #12121a;
    color: #fff;
    font-weight: bold;
  }

  input[readonly] {
    background: #222;
    color: #aaa;
    cursor: not-allowed;
  }

  .checkboxLabel {
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
    font-weight: bold;
    color: #ff6ec7;
    padding: 6px 10px;
    border-radius: 12px;
    border: 1px solid #ff6ec7;
  }

  .checkboxLabel input[type="checkbox"] {
    accent-color: #7afcff;
    width: 20px;
    height: 20px;
  }

  .checkboxLabel.checked {
    background-color: #7afcff;
    color: #0a0a0f;
    border-color: #ff6ec7;
  }

  .tooltip {
    display: inline-block;
    position: relative;
    cursor: pointer;
    color: #fff;
    background-color: #ff6ec7;
    border-radius: 50%;
    width: 22px;
    height: 22px;
    text-align: center;
    line-height: 22px;
    font-weight: bold;
    font-size: 14px;
  }

  .tooltiptext {
    visibility: hidden;
    width: max-content;
    max-width: 280px;
    background-color: #222;
    color: #7afcff;
    text-align: left;
    padding: 6px 10px;
    border-radius: 6px;
    position: absolute;
    z-index: 1;
    top: -5px;
    left: 28px;
    opacity: 0;
    transition: opacity 0.2s;
    font-size: 13px;
    border: 1px solid #7afcff;
  }

  .tooltip:hover .tooltiptext {
    visibility: visible;
    opacity: 1;
  }

  .result {
    margin-top: 12px;
    padding: 16px;
    background: #12121a;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.5);
    font-size: 0.95em;
    line-height: 1.5em;
    border: 1px solid #7afcff;
  }

  .finalValue {
    font-size: 1.8em;
    color: #ff6ec7;
    font-weight: bold;
    display: inline-block;
    margin-left: 0.3em;
  }

  .note {
    color: #ff4d4f;
    margin-top: 10px;
    font-size: 0.9em;
  }

  @media (max-width: 768px) {
    .formRow label { width: 140px; }
    input[type="number"] { width: 80px; }
  }
  @media (max-width: 480px) {
    .formRow { flex-direction: column; align-items: flex-start; }
    .formRow label { width: 100%; }
    input[type="number"] { width: 100%; }
  }
</style>
</head>
<body>

<h1>æœ€çµ‚æ”»æ’ƒåŠ›ãƒ»ã‚«ãƒ¼ãƒ‰å€ç‡è¨ˆç®—ãƒ„ãƒ¼ãƒ«</h1>

<div class="container">

  <!-- æœ€çµ‚æ”»æ’ƒåŠ›è¨ˆç®— -->
  <div class="section">
    <h2>æœ€çµ‚æ”»æ’ƒåŠ›è¨ˆç®—</h2>

    <div class="formRow">
      <label>åŸºæœ¬æ”»æ’ƒåŠ›</label>
      <input type="number" id="baseAttack" value="">
      <label>æ”»æ’ƒåŠ›å¢—åŠ ç‡ (%)</label>
      <input type="number" id="attackIncreaseRate" value="">
    </div>

    <div class="formRow">
      <label>ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼æ”»æ’ƒåŠ›</label>
      <input type="number" id="partnerAttack" value="">
      <label>ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼æ”»æ’ƒåŠ› (%)</label>
      <input type="number" id="partnerAttackPercent" value="">
    </div>

    <div class="formRow">
      <label>è¨˜æ†¶å›ºå®šå€¤</label>
      <input type="number" id="memoryFixed" value="">
      <label>æ„›æƒ…å›ºå®šå€¤</label>
      <input type="number" id="affectionFixed" value="">
    </div>

    <div class="formRow">
      <label>è£…å‚™æ”»æ’ƒåŠ› (%)</label>
      <input type="number" id="equipmentAttackPercent" value="">
      <label>è£…å‚™æ”»æ’ƒåŠ›</label>
      <input type="number" id="equipmentAttack" value="">
    </div>

    <div class="note">
      â€»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹åŸºæœ¬æ”»æ’ƒåŠ›ã¯æ„›æƒ…å›ºå®šå€¤ãŒåŠ ç®—æ¸ˆã¿ã®ãŸã‚æ³¨æ„
    </div>

    <div class="result" id="attackResult"></div>
  </div>

  <!-- æœ€çµ‚ã‚«ãƒ¼ãƒ‰å€ç‡è¨ˆç®— -->
  <div class="section">
    <h2>æœ€çµ‚ã‚«ãƒ¼ãƒ‰å€ç‡è¨ˆç®—</h2>

    <div class="formRow">
      <label>åŸºæœ¬å€ç‡ (%)</label>
      <input type="number" id="baseCardRate" value="">
    </div>

    <div class="formRow">
      <span class="tooltip">?<span class="tooltiptext">æ½œåœ¨åŠ›å¼·åŒ–ã§ä¸€éƒ¨å¯¾è±¡æœ‰ã‚Š</span></span>
      <label>æ½œåœ¨åŠ ç®—å€¤ (%)</label>
      <input type="number" id="latentAdd" value="">

      <span class="tooltip">?<span class="tooltiptext">åŸºç¤ã€å›ºæœ‰ã€å…±æœ‰ã‚«ãƒ¼ãƒ‰ã®å¼·åŒ–ã«ã‚ˆã£ã¦å¤‰å‹•</span></span>
      <label>æ½œåœ¨ä¹—ç®—å€¤ (%)</label>
      <input type="number" id="latentMul" value="">
    </div>

    <div class="formRow">
      <span class="tooltip">?<span class="tooltiptext">ãƒãƒ•ã‚„ã‚¹ã‚­ãƒ«ã§å¤‰å‹•ã€€å£«æ°—ãƒãƒ•1ã¤ã«ã¤ã+20ï¼…</span></span>
      <label>æ±ç”¨åŠ ç®—å€¤ (%)</label>
      <input type="number" id="versatileAdd" value="">

      <span class="tooltip">?<span class="tooltiptext">ãƒãƒ•ã‚„ã‚¹ã‚­ãƒ«ã§å¤‰å‹•ã€€ä¸å±ˆãƒãƒ•1ã¤ã«ã¤ã+20ï¼…</span></span>
      <label>æ±ç”¨æ¸›ç®—å€¤ (%)</label>
      <input type="number" id="versatileSubtract" value="">
    </div>

    <div class="formRow">
      <span class="tooltip">?<span class="tooltiptext">ã‚«ãƒ¼ãƒ‰åŠ¹æœã‚„è¨˜æ†¶ã€ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã§å¤‰å‹•</span></span>
      <label>æ±ç”¨ä¹—ç®—å€¤ (%)</label>
      <input type="number" id="versatileMul" value="">
    </div>

    <div class="formRow">
      <label class="checkboxLabel"><input type="checkbox" id="attributeRate"> æœ‰åˆ©å±æ€§å€ç‡ (+25%)</label>
      <label class="checkboxLabel"><input type="checkbox" id="debuffRate"> è„†å¼±å€ç‡ (+50%)</label>
      <label class="checkboxLabel"><input type="checkbox" id="damageReduction"> ãƒ€ãƒ¡ãƒ¼ã‚¸è»½æ¸› (-25%)</label>
      <label class="checkboxLabel"><input type="checkbox" id="weakenRate"> å¼±ä½“åŒ–å€ç‡ (-25%)</label>
    </div>

    <div class="result" id="cardResult"></div>
  </div>

  <!-- âœ… ATKãƒ™ãƒ¼ã‚¹æœ€çµ‚ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®— -->
  <div class="section atkDamageSection">
    <h2>ATKãƒ™ãƒ¼ã‚¹æœ€çµ‚ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—</h2>

    <div class="formRow">
      <span class="tooltip">?<span class="tooltiptext">ä¸Šéƒ¨ã®è¨ˆç®—æ©Ÿã§è¨ˆç®—å¯èƒ½</span></span>
      <label>æœ€çµ‚ã‚«ãƒ¼ãƒ‰å€ç‡ (%)</label>
      <input type="number" id="atkCardRate" value="">
      <span class="tooltip">?<span class="tooltiptext">ä¸Šéƒ¨ã®è¨ˆç®—æ©Ÿã§è¨ˆç®—å¯èƒ½</span></span>
      <label>æœ€çµ‚æ”»æ’ƒåŠ›</label>
      <input type="number" id="atkFinalAtk" value="">
    </div>

    <div class="formRow">
      <span class="tooltip">?<span class="tooltiptext">è¨˜æ†¶ã®æ¬ ç‰‡ã€æ¸‡æœ›ã€‘ã®ãƒ¡ã‚¤ãƒ³OPã§ã‚ã‚‹å±æ€§ãƒ€ãƒ¡ãƒ¼ã‚¸é‡</span></span>
      <label>å±æ€§ä¹—ç®—å€¤ (%)</label>
      <input type="number" id="atkAttribute" value="">
      <span class="tooltip">?<span class="tooltiptext">è¿½åŠ ãƒ€ãƒ¡ãƒ¼ã‚¸é‡ã‚„æŒç¶šãƒ€ãƒ¡ãƒ¼ã‚¸é‡</span></span>
      <label>ç‰¹æ®Šãƒ€ãƒ¡ãƒ¼ã‚¸ä¹—ç®—å€¤ (%)</label>
      <input type="number" id="atkSpecial" value="">
    </div>

    <div class="formRow">
      <span class="tooltip">?<span class="tooltiptext">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹æ•°å€¤ã‹ã‚‰100ã‚’å¼•ã„ãŸå€¤</span></span>
      <label>ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ€ãƒ¡ãƒ¼ã‚¸å€ç‡ (%)</label>
      <input type="number" id="atkCritical" value="">
      <span class="tooltip">?<span class="tooltiptext">ãƒã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿ã®ãŸã‚é€†ç®—ã§ã—ã‹è¨ˆç®—ä¸å¯èƒ½</span></span>
      <label>æ•µé˜²å¾¡ä¿‚æ•° (%)</label>
      <input type="number" id="atkDefense" value="">
    </div>

    <div class="formRow">
      <span class="tooltip">?<span class="tooltiptext">65%ã‚«ãƒƒãƒˆã¯å›ºå®šã®ãŸã‚ç·¨é›†ä¸å¯</span></span>
      <label>å›ºå®šãƒ€ãƒ¡ãƒ¼ã‚¸æ¸›ç®—å€ç‡ (%)</label>
      <!-- ğŸ”’ ã“ã®ãƒ•ã‚©ãƒ¼ãƒ ã®ã¿å›ºå®š -->
      <input type="number" id="atkFixedReduction" value="65" readonly>
      <span class="tooltip">?<span class="tooltiptext">ä»»æ„ã®ãƒ’ãƒƒãƒˆæ•°ã‚’è¨˜å…¥</span></span>
      <label>ãƒ’ãƒƒãƒˆæ•°</label>
      <input type="number" id="atkHitCount" value="">
    </div>

    <div class="result" id="atkDamageResult"></div>
  </div>

</div>

<script>
function calculate() {
  const baseAttack = +document.getElementById("baseAttack").value;
  const attackIncreaseRate = +document.getElementById("attackIncreaseRate").value / 100;
  const partnerAttack = +document.getElementById("partnerAttack").value;
  const memoryFixed = +document.getElementById("memoryFixed").value;
  const affectionFixed = +document.getElementById("affectionFixed").value;
  const partnerAttackPercent = +document.getElementById("partnerAttackPercent").value / 100;
  const equipmentAttackPercent = +document.getElementById("equipmentAttackPercent").value / 100;
  const equipmentAttack = +document.getElementById("equipmentAttack").value;

  const baseTotalAttack = Math.floor(
    baseAttack * (1 + attackIncreaseRate) +
    partnerAttack +
    memoryFixed +
    affectionFixed
  );
  const baseAttackMultiplier = 1 + partnerAttackPercent + equipmentAttackPercent;
  const finalAttack = Math.round(baseTotalAttack * baseAttackMultiplier + equipmentAttack);

  document.getElementById("attackResult").innerHTML = `
    <strong>åŸºç¤æ”»æ’ƒåŠ›:</strong> ${isNaN(baseTotalAttack)?'-':baseTotalAttack.toFixed(0)}<br>
    <strong>åŸºç¤æ”»æ’ƒä¹—ç®—å€¤:</strong> ${isNaN(baseAttackMultiplier)?'-':(baseAttackMultiplier*100).toFixed(1)}%<br>
    <strong>å›ºå®šæ”»æ’ƒåŠ›:</strong> ${isNaN(equipmentAttack)?'-':equipmentAttack.toFixed(0)}<br>
    <strong>æœ€çµ‚æ”»æ’ƒåŠ›:</strong> <span class="finalValue">${isNaN(finalAttack)?'-':finalAttack.toFixed(0)}</span>
  `;

  const baseCardRate = +document.getElementById("baseCardRate").value / 100;
  const latentAdd = +document.getElementById("latentAdd").value / 100;
  const latentMul = +document.getElementById("latentMul").value / 100;
  const versatileMul = +document.getElementById("versatileMul").value / 100;
  const versatileAdd = +document.getElementById("versatileAdd").value / 100;
  const versatileSubtract = +document.getElementById("versatileSubtract").value / 100;

  const attributeRate = document.getElementById("attributeRate").checked ? 0.25 : 0;
  const debuffRate = document.getElementById("debuffRate").checked ? 0.5 : 0;
  const damageReduction = document.getElementById("damageReduction").checked ? 0.25 : 0;
  const weakenRate = document.getElementById("weakenRate").checked ? 0.25 : 0;

  let calcBaseCardRate = ((baseCardRate + latentAdd)*(1+latentMul)*(1+versatileMul) + versatileAdd - versatileSubtract);
  let situationMultiplier = (1+attributeRate)*(1+debuffRate)*(1-damageReduction)*(1-weakenRate);
  let finalCardRateValue = calcBaseCardRate * situationMultiplier;

  document.getElementById("cardResult").innerHTML = `
    <strong>è¨ˆç®—å¾ŒåŸºæœ¬ã‚«ãƒ¼ãƒ‰å€ç‡:</strong> ${isNaN(calcBaseCardRate)?'-':(calcBaseCardRate*100).toFixed(2)}%<br>
    <strong>çŠ¶æ³è£œæ­£ä¹—ç®—å€¤:</strong> ${isNaN(situationMultiplier)?'-':(situationMultiplier*100).toFixed(2)}%<br>
    <strong>æœ€çµ‚ã‚«ãƒ¼ãƒ‰å€ç‡:</strong> <span class="finalValue">${isNaN(finalCardRateValue)?'-':(finalCardRateValue*100).toFixed(2)}%</span>
  `;

  const atkCardRate = +document.getElementById("atkCardRate").value / 100;
  const atkFinalAtk = +document.getElementById("atkFinalAtk").value;
  const atkAttribute = +document.getElementById("atkAttribute").value / 100;
  const atkSpecial = +document.getElementById("atkSpecial").value / 100;
  const atkCritical = +document.getElementById("atkCritical").value / 100;
  const atkDefense = +document.getElementById("atkDefense").value / 100;
  const atkFixedReduction = +document.getElementById("atkFixedReduction").value / 100;
  const atkHitCount = +document.getElementById("atkHitCount").value;

  const normalSingle =
    atkFinalAtk *
    atkCardRate *
    (1 + atkAttribute) *
    (1 + atkSpecial) *
    (1 - atkDefense) *
    (1 - atkFixedReduction);

  const criticalSingle =
    atkFinalAtk *
    atkCardRate *
    (1 + atkAttribute) *
    (1 + atkSpecial) *
    (1 + atkCritical) *
    (1 - atkDefense) *
    (1 - atkFixedReduction);

  const normalMulti = normalSingle * atkHitCount;
  const criticalMulti = criticalSingle * atkHitCount;

  document.getElementById("atkDamageResult").innerHTML = `
    <strong>é€šå¸¸ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ˆå˜ç™ºï¼‰:</strong> <span class="finalValue">${isNaN(normalSingle)?'-':Math.round(normalSingle)}</span><br>
    <strong>ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ˆå˜ç™ºï¼‰:</strong> <span class="finalValue">${isNaN(criticalSingle)?'-':Math.round(criticalSingle)}</span><br>
    <strong>é€šå¸¸ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ˆè¤‡æ•°ãƒ’ãƒƒãƒˆï¼‰:</strong> <span class="finalValue">${isNaN(normalMulti)?'-':Math.round(normalMulti)}</span><br>
    <strong>ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ˆè¤‡æ•°ãƒ’ãƒƒãƒˆï¼‰:</strong> <span class="finalValue">${isNaN(criticalMulti)?'-':Math.round(criticalMulti)}</span>
  `;
}

document.querySelectorAll(".checkboxLabel input[type=checkbox]").forEach(checkbox => {
  checkbox.addEventListener("change", function() {
    if (this.checked) this.parentElement.classList.add("checked");
    else this.parentElement.classList.remove("checked");
    calculate();
  });
});

document.querySelectorAll("input[type=number]").forEach(input => input.addEventListener("input", calculate));
window.addEventListener("DOMContentLoaded", calculate);
</script>

</body>
</html>
